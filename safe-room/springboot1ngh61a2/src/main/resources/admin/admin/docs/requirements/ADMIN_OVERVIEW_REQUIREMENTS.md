# 后台管理系统总体需求文档（Admin Console v1.0）

> 版本：v1.0  
> 更新日期：2025-11-15（计划日期）  
> 适用项目：`springboot1ngh61a2/src/main/resources/admin/admin`

---

## 0. 设计关键词（Design Keywords）

效率优先 · 数据一目了然 · 稳健权限 · 浅色专业 · 低噪动效

> 目标：让运营/教练/管理员在最少点击下完成配置、审批、统计等任务。

---

## 1. 系统整体逻辑结构

| 顺序 | 区块/模块 | 目的 |
| --- | --- | --- |
| ① | 认证入口（登录/注册/忘记密码） | 确保仅授权角色可进入后台 |
| ② | 布局壳体（顶部导航 + 侧边菜单 + 面包屑 + TagsView） | 提供全局导航、快速切换上下文 |
| ③ | 仪表盘首页 | 汇总关键指标/趋势，支持角色定制 |
| ④ | 业务模块 CRUD（课程、教练、会员等） | 支持数据录入、审核、导出、批量操作 |
| ⑤ | 配置中心（轮播、菜单、系统参数） | 运营可视化配置站点内容 |
| ⑥ | 系统管理（权限、日志、账号、消息） | 管理员掌控安全与合规 |

---

## 2. 视觉与品牌规范

### 2.1 色彩体系

| 名称 | 颜色 | 用途 |
| --- | --- | --- |
| 主背景色 | `#F3F3F3` | 内容区背景 |
| 强调色（亮能蓝） | `#3A80FF` | 主按钮、链接、图表线条、激活状态 |
| 辅助色（薄雾灰） | `#A0A4B3` | 次级文字、表头说明 |
| 文字主色 | `#333` | 主要文字内容 |
| 文字次色 | `#666` | 次要文字内容 |
| 边框色 | `rgba(0,0,0,0.06)` | 边框、分割线 |
| 危险色 | `#FF5F5F` | 删除、警告提示 |
| 成功色 | `#4ECB71` | 状态 Pill / 成功提示 |

> 要求：采用浅色主题，提升可读性和专业感，与前台黑金主题形成差异化。

### 2.2 字体与排版

- 基础字体：`"PingFang SC", "Microsoft YaHei", sans-serif`  
- 标题：14~18px，字重 600；正文：13~14px；表格数值：13px 等宽对齐  
- 表格列间距 ≥ 16px，保持可读性

### 2.3 组件与卡片

- 卡片圆角 8px，背景 `#FFFFFF`，阴影 `0 2px 8px rgba(0,0,0,0.08)`  
- 边框：`1px solid rgba(0,0,0,0.06)`  
- 表格交替行背景：`#FAFAFA`  
- 图表区域：保持 320px 以上高度，顶部留出标题与筛选器区域

---

## 3. 功能域与模块说明

### 3.1 核心功能模块

| 模块分类 | 模块名称 | 核心能力 | 数据来源 / 接口 | 实现状态 | 备注 |
| --- | --- | --- | --- | --- |
| **用户管理** | 用户管理 | 用户信息维护、会员到期提醒 | `/yonghu/*` | ✅ | 支持到期提醒功能，基于ModuleCrudPage |
| | 健身教练管理 | 教练信息管理、私教预约 | `/jianshenjiaolian/*` | ✅ | 教练可查看自己相关数据，角色权限控制 |
| **课程管理** | 健身课程管理 | 课程CRUD、评论查看、预约统计 | `/jianshenkecheng/*` | ✅ | 支持课程预约和评论管理，首页统计 |
| | 课程类型管理 | 课程分类维护 | `/kechengleixing/*` | ✅ | 基础数据管理，课程分类设置 |
| | 课程预约管理 | 预约审核、支付管理 | `/kechengyuyue/*` | ✅ | 支持预约流程管理，财务统计 |
| | 课程退款管理 | 退款申请处理 | `/kechengtuike/*` | ✅ | 财务相关操作，退款流程 |
| | 私教预约管理 | 私教课程预约 | `/sijiaoyuyue/*` | ✅ | 教练一对一服务，审核功能 |
| **会员管理** | 会员卡管理 | 会员卡类型设置 | `/huiyuanka/*` | ✅ | 会员卡配置，价格设置 |
| | 会员卡购买管理 | 购买记录管理 | `/huiyuankagoumai/*` | ✅ | 销售数据统计，首页图表展示 |
| | 会员续费管理 | 续费记录管理 | `/huiyuanxufei/*` | ✅ | 续费统计，收入分析 |
| | 到期提醒管理 | 会员到期提醒 | `/daoqitixing/*` | ✅ | 自动化提醒功能，权限控制 |
| **设备管理** | 健身器材管理 | 设备信息维护 | `/jianshenqicai/*` | ✅ | 设备资产管理，基础信息维护 |
| **内容管理** | 轮播图管理 | 首页轮播配置 | `/config/*` | ✅ | 系统配置，图片上传 |
| | 公告管理 | 公告发布管理 | `/news/*` | ✅ | 富文本编辑，内容发布 |
| | 公告分类管理 | 公告分类维护 | `/newstype/*` | ✅ | 内容分类，分类管理 |
| **系统管理** | 资产管理 | 文件资源管理 | `/assets/*` | ✅ | 支持批量上传，文件管理 |
| | 管理员用户管理 | 后台用户管理 | `/users/*` | ✅ | 管理员账号管理，角色分配 |
| | 操作日志管理 | 系统操作记录 | `/operationLog/*` | ✅ | 审计日志，操作追溯 |
| | 服务状态监控 | 系统状态查看 | `/serviceStatus/*` | ✅ | 系统监控，状态检查 |
| | 法律条款管理 | 条款内容管理 | `/legalTerms/*` | ✅ | 法律合规，富文本编辑 |
| | 反馈管理 | 用户反馈处理 | `/chat/*` | ✅ | 客服功能，用户沟通 |

### 3.2 核心系统功能

| 模块 | 核心能力 | 数据来源 / 接口 | 实现状态 | 备注 |
| --- | --- | --- | --- | --- |
| 鉴权模块 | 登录、注册、权限路由守卫、Token 续期 | `/auth/login`, `/auth/register`, 角色表 | ✅ | 支持多角色（管理员/教练/客服），安全验证 |
| 布局模块 | `IndexMain`、侧边菜单、面包屑、TagsView | 前端常量 `menu.ts` + 接口 | ✅ | 支持菜单折叠、最近访问记录，响应式设计 |
| 仪表盘 | 数据总览卡片 + 图表 | 各模块统计接口 | ✅ | 允许按角色配置可见卡片，ECharts图表展示 |
| CRUD 模块 | 统一列表、筛选、表单、批量操作 | `/moduleKey/list`, `/save`, `/update`, `/delete` | ✅ | 支持字段动态渲染，类型智能识别 |
| 运营配置 | 轮播、公告、课程推荐 | `/config/list`, `/news/list` | ✅ | 提供富文本、图片上传，内容管理 |
| 系统管理 | 权限、日志、操作记录 | `/menu/list`, `/logs/list` | ✅ | 关键操作需写入审计日志，安全监控 |

---

## 4. 交互与动效规范

| 维度 | 规范 |
| --- | --- |
| 动画 | 仅使用 0.2~0.35s 淡入/滑入/折叠动画；图表加载使用渐显 |
| Hover | 按钮亮度 +8%，表格行背景 `rgba(58,128,255,0.08)` |
| Loading | 列表与按钮使用 Element Plus Loading / Skeleton |
| 空状态 | 提供图标 + 20 字以内文案 + CTA（例如“去新增课程”） |
| 批量操作 | 多选后浮出工具条，展示已选数量与操作按钮 |
| 错误提示 | 表单字段下方红色提示，顶部使用 `ElMessage.error` |

---

## 5. 权限与安全要求

1. **基于角色的菜单/按钮控制**：`menu.ts` 中 `buttons` 字段需与后端权限点对应。  
2. **接口校验**：所有 `/moduleKey` CRUD 接口需验证 Token & Role。  
3. **操作日志**：新增/编辑/删除/导出等写入 `operation_log` 表。  
4. **会话安全**：Token 过期需弹出提示并跳转登录；支持"记住我"7 天。  
5. **数据隔离**：教练角色仅能看到与自己相关的课程、预约数据。  
6. **上传安全**：限制文件类型/大小，统一走 `/upload/file` 接口。

### 5.1 权限函数使用说明

**`isAuth(tableName: string, key: string): boolean`**

- **位置**：`src/utils/utils.ts`
- **功能**：检查当前用户是否具有指定表/模块的特定操作权限
- **参数**：
  - `tableName`：表名/模块名（如 `'yonghu'`, `'jianshenkecheng'`）
  - `key`：权限键（如 `'Add'`, `'View'`, `'Edit'`, `'Delete'`, `'Export'`）
- **返回值**：`true` 表示有权限，`false` 表示无权限
- **使用示例**：
  ```typescript
  import { isAuth } from '@/utils/utils'
  
  // 检查是否有新增会员的权限
  if (isAuth('yonghu', 'Add')) {
    // 显示新增按钮
  }
  
  // 检查是否有删除课程的权限
  if (isAuth('jianshenkecheng', 'Delete')) {
    // 显示删除按钮
  }
  ```
- **权限数据来源**：从 `menu.ts` 中根据当前用户角色（`storage.get('role')`）查找对应的 `buttons` 数组
- **注意事项**：
  - 前端权限检查仅用于 UI 显示控制，后端必须同时进行权限验证
  - 若角色不存在，默认返回 `false`
  - 权限键需与 `menu.ts` 中 `buttons` 数组的值完全匹配（区分大小写）

---

## 6. 响应式与适配

| 终端 | 适配策略 |
| --- | --- |
| ≥1440px | 三栏布局（菜单 + 内容 + 侧卡片），仪表盘 4 列卡片 |
| 1200-1439px | 菜单可折叠，仪表盘 3 列卡片 |
| 992-1199px | 菜单默认折叠，表格横向滚动提示 |
| <992px | 显示“建议使用桌面端”，但仍可基本操作；隐藏图表动画 |

> 移动端仅提供应急处理能力，不做深度优化。

---

## 7. 技术栈与依赖

| 领域 | 说明 | 版本/组件 | 实现状态 |
| --- | --- | --- |
| **前端框架** | Vue 3 + TypeScript + Vite | ^3.5.13, ~5.3.3, ^5.0.8 | ✅ |
| **UI 库** | Element Plus | ^2.8.8，定制浅色主题，专业蓝 `#3A80FF` | ✅ |
| **状态管理** | Pinia | ^2.2.6，标签页和错误状态管理 | ✅ |
| **网络请求** | Axios 封装 | ^1.7.9，统一错误处理和拦截器 | ✅ |
| **图表库** | ECharts | ^5.4.3，首页数据可视化 | ✅ |
| **测试框架** | Vitest + Playwright | 单元测试和端到端测试 | ✅ |
| **图标库** | SVG图标库 | 159个自定义SVG图标，Element Plus图标 | ✅ |
| **富文本编辑器** | Vue Quill | @vueup/vue-quill ^1.2.0，内容编辑 | ✅ |
| **文件上传** | 自建上传组件 | FileUpload.vue，支持图片/文件上传 | ✅ |
| **路由权限** | 自建权限守卫 | 基于menu.ts配置的动态路由权限 | ✅ |
| **安全工具** | 加密和防护 | crypto-js ^4.2.0，DOMPurify ^3.0.8 | ✅ |

---

## 8. 开发交付件

1. 需求文档（本文件 + 子页面文档）  
2. 可配置的菜单/路由清单（含权限点映射）  
3. 统一的 CRUD 组件与示例页  
4. QA 用例：角色登录、数据操作、导出、权限拦截  
5. 端到端测试脚本更新（登录、导航、模块 CRUD）

---

## 9. 验收标准

| 维度 | 标准 | 实现状态 | 验收方式 |
| --- | --- | --- |
| **功能完整性** | 所有业务模块CRUD操作正常；权限控制准确；数据导出功能可用 | ✅ | 手工测试各模块功能 |
| **性能表现** | 列表加载流畅；图表渲染快速；首屏加载优化 | ✅ | Lighthouse / 性能监控 |
| **视觉一致性** | Element Plus主题正确生效；响应式布局适配；动效流畅 | ✅ | 视觉验收 + 跨设备测试 |
| **安全合规** | Token认证有效；权限隔离准确；操作日志完整；数据脱敏 | ✅ | 安全审计 + 日志检查 |
| **用户体验** | 关键操作 ≤ 3 步；错误提示友好；批量操作便捷；搜索过滤高效 | ✅ | 用户可用性测试 |
| **数据准确性** | 统计数据与实际一致；导出数据完整；表单验证严格 | ✅ | 数据一致性检查 |
| **兼容性** | Chrome/Edge ≥ 90；Firefox ≥ 88；Safari ≥ 14 | ✅ | 浏览器兼容性测试 |
| **可维护性** | TypeScript类型完整；代码规范统一；文档更新及时 | ✅ | 代码审查 + 文档检查 |

---

## 10. 待办与风险

### 10.1 高优先级待办

- [ ] **数据导出功能完善**：实现各模块的Excel导出功能，目前仅部分模块支持
- [ ] **批量操作扩展**：完善批量删除、批量审核等功能的用户体验
- [ ] **富文本编辑器优化**：完善`RichTextEditor.vue`组件的功能和安全性
- [ ] **文件上传安全加固**：完善文件类型校验、大小限制和存储安全

### 10.2 中优先级待办

- [ ] **角色权限动态化**：将`menu.ts`权限配置与后端权限表同步，避免硬编码
- [ ] **统计接口性能优化**：首页统计接口增加缓存和分页，避免大数据量阻塞
- [ ] **操作日志数据管理**：设计日志归档和清理策略，控制数据量增长
- [ ] **移动端适配改进**：提升移动设备上的基本操作体验

### 10.3 低优先级待办

- [ ] **高级筛选功能**：实现多字段组合筛选和高级搜索
- [ ] **数据导入功能**：实现批量数据导入和模板下载
- [ ] **图表交互增强**：增加图表钻取、数据详情等交互功能
- [ ] **主题切换功能**：支持明暗主题切换（目前仅支持浅色）

### 10.4 技术债务

- [ ] **TypeScript类型完善**：补充API响应类型定义和组件Props类型
- [ ] **测试覆盖率提升**：完善单元测试和集成测试用例
- [ ] **代码规范统一**：统一代码风格和注释规范

> **主要风险**：
> 1. 权限配置硬编码可能导致权限管理不灵活
> 2. 大数据量场景下的性能问题（如统计接口阻塞）
> 3. 文件上传安全漏洞（需完善校验和存储安全）
> 4. 移动端体验不足可能影响应急使用场景

---

