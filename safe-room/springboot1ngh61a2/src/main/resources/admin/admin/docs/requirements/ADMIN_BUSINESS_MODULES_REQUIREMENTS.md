# 业务模块需求文档（Business Modules v1.0）

> 版本：v1.0
> 更新日期：2025-11-16
> 适用组件：`src/views/modules/components/ModuleCrudPage.vue`
> 覆盖模块：反馈管理、资产管理、服务状态监控、法律条款管理等

---

## 0. 设计关键词

模块化 · 标准化 · 权限控制 · 数据完整性 · 用户友好

---

## 1. 反馈管理（Chat/Feedback）

### 1.1 功能说明

管理用户反馈消息，支持查看、回复、标记处理状态，实现客服功能。

### 1.2 数据字段

| 字段 | 类型 | 说明 | 必填 |
| --- | --- | --- | --- |
| `id` | Long | 主键 | 是 |
| `userid` | Long | 用户ID | 是 |
| `username` | String | 用户名 | 是 |
| `content` | String | 反馈内容 | 是 |
| `reply` | String | 回复内容 | 否 |
| `status` | Integer | 状态（0-未回复，1-已回复） | 是 |
| `addtime` | Date | 提交时间 | 自动 |
| `replytime` | Date | 回复时间 | 否 |

### 1.3 功能需求

| 功能 | 说明 | 接口 | 权限 |
| --- | --- | --- | --- |
| 列表查看 | 显示所有反馈，按时间倒序 | `GET /chat/page` | View |
| 详情查看 | 查看反馈详情和回复记录 | 复用ModuleCrudPage详情 | View |
| 回复反馈 | 回复用户反馈，更新状态 | `POST /chat/update` | Edit |
| 状态管理 | 标记为已处理/未处理 | 通过status字段 | Edit |
| 批量操作 | 批量标记为已处理 | 批量更新接口 | Edit |

### 1.4 交互规范

- 未回复反馈高亮显示
- 回复后自动标记为已处理
- 支持富文本回复内容
- 显示回复时间戳

---

## 2. 资产管理（Assets）

### 2.1 功能说明

管理系统资源文件，支持图片、文档等文件的上传、分类、批量管理。

### 2.2 数据字段

| 字段 | 类型 | 说明 | 必填 |
| --- | --- | --- | --- |
| `id` | Long | 主键 | 是 |
| `name` | String | 文件名 | 是 |
| `url` | String | 文件URL | 是 |
| `type` | String | 文件类型（image/video/file） | 是 |
| `size` | Long | 文件大小（字节） | 是 |
| `category` | String | 分类标签 | 否 |
| `addtime` | Date | 上传时间 | 自动 |
| `userid` | Long | 上传用户ID | 是 |

### 2.3 功能需求

| 功能 | 说明 | 接口 | 权限 |
| --- | --- | --- | --- |
| 文件上传 | 支持单文件和批量上传 | `POST /upload/file` | Add |
| 文件列表 | 按类型/时间/大小排序显示 | `GET /assets/page` | View |
| 文件预览 | 图片预览，文档下载 | 直接访问URL | View |
| 文件删除 | 删除单个或批量删除文件 | `POST /assets/delete` | Delete |
| 文件分类 | 按类型筛选和管理 | 前端筛选 | View |
| 批量下载 | 批量下载选中的文件 | 压缩包下载 | Export |

### 2.4 文件类型支持

- **图片**：jpg、png、gif、webp、svg（最大5MB）
- **文档**：pdf、doc、docx、xls、xlsx、txt（最大10MB）
- **视频**：mp4、avi、mov（最大50MB）
- **其他**：zip、rar压缩包（最大100MB）

---

## 3. 服务状态监控（Service Status）

### 3.1 功能说明

监控系统各项服务的运行状态，包括数据库连接、缓存服务、外部API等。

### 3.2 监控项目

| 服务名称 | 检查内容 | 检查频率 | 告警级别 |
| --- | --- | --- | --- |
| 数据库连接 | MySQL/PostgreSQL连接状态 | 每5分钟 | 高 |
| Redis缓存 | 缓存服务连接和响应 | 每5分钟 | 中 |
| 文件存储 | MinIO/S3存储服务状态 | 每10分钟 | 中 |
| 外部API | 第三方服务接口可用性 | 每15分钟 | 低 |
| 系统资源 | CPU、内存、磁盘使用率 | 每分钟 | 高 |

### 3.3 功能需求

| 功能 | 说明 | 接口 | 权限 |
| --- | --- | --- | --- |
| 状态概览 | 显示所有服务的当前状态 | `GET /serviceStatus/list` | View |
| 详细监控 | 查看单个服务的详细状态信息 | `GET /serviceStatus/info/{id}` | View |
| 手动检查 | 手动触发服务状态检查 | `POST /serviceStatus/check` | Admin |
| 历史记录 | 查看服务状态的历史变化 | `GET /serviceStatus/history` | View |
| 告警设置 | 配置告警阈值和通知方式 | `POST /serviceStatus/config` | Admin |

### 3.4 状态显示规范

- **正常**：绿色 ✓，响应时间 < 1000ms
- **警告**：黄色 ⚠️，响应时间 1000-3000ms
- **异常**：红色 ✗，连接失败或响应时间 > 3000ms
- **离线**：灰色 ○，服务不可用

---

## 4. 法律条款管理（Legal Terms）

### 4.1 功能说明

管理系统的法律条款和用户协议内容，支持多语言版本。

### 4.2 数据字段

| 字段 | 类型 | 说明 | 必填 |
| --- | --- | --- | --- |
| `id` | Long | 主键 | 是 |
| `title` | String | 条款标题 | 是 |
| `content` | String | 条款内容（富文本） | 是 |
| `type` | String | 条款类型（tos/privacy/cookies） | 是 |
| `language` | String | 语言版本（zh/en） | 是 |
| `version` | String | 版本号 | 是 |
| `status` | Integer | 状态（0-草稿，1-发布） | 是 |
| `addtime` | Date | 创建时间 | 自动 |
| `updatetime` | Date | 更新时间 | 自动 |

### 4.3 功能需求

| 功能 | 说明 | 接口 | 权限 |
| --- | --- | --- | --- |
| 条款列表 | 按类型和语言筛选显示 | `GET /legalTerms/page` | View |
| 条款编辑 | 富文本编辑条款内容 | `POST /legalTerms/update` | Edit |
| 版本管理 | 创建新版本，保留历史版本 | `POST /legalTerms/save` | Add |
| 发布管理 | 发布/撤销条款发布 | 通过status字段 | Admin |
| 多语言支持 | 支持中英文版本切换 | 前端语言筛选 | View |
| 内容预览 | 预览条款的渲染效果 | 富文本预览 | View |

### 4.4 条款类型

- **服务条款（tos）**：用户服务协议
- **隐私政策（privacy）**：隐私数据处理政策
- **Cookie政策（cookies）**：Cookie使用政策
- **其他条款**：其他法律文件

---

## 5. 通用业务模块规范

### 5.1 权限控制标准

所有业务模块统一使用以下权限键：

| 权限键 | 说明 | 适用模块 |
| --- | --- | --- |
| `Add` | 新增数据 | 所有模块 |
| `View` | 查看数据 | 所有模块 |
| `Edit` | 编辑数据 | 所有模块 |
| `Delete` | 删除数据 | 除日志类模块外 |
| `Export` | 导出数据 | 支持导出的模块 |
| `Review` | 审核数据 | 需审核的业务模块 |

### 5.2 数据操作规范

#### 5.2.1 新增操作
- 表单字段动态生成，支持多种数据类型
- 必填字段校验，友好错误提示
- 成功后刷新列表，显示成功消息
- 支持文件上传的模块需显示上传进度

#### 5.2.2 编辑操作
- 预填充现有数据，防止数据丢失
- 只允许编辑有权限的字段
- 修改后记录操作日志
- 涉及状态变更的操作需二次确认

#### 5.2.3 删除操作
- 软删除优先，支持恢复机制
- 批量删除需二次确认
- 显示删除数量和影响范围
- 重要数据删除需超级管理员权限

### 5.3 搜索和筛选

#### 5.3.1 通用搜索
- 关键词搜索：支持模糊匹配多个字段
- 时间范围筛选：开始时间和结束时间
- 状态筛选：按业务状态快速筛选
- 高级筛选：支持多条件组合（预留扩展）

#### 5.3.2 模块特定筛选

| 模块 | 特定筛选条件 |
| --- | --- |
| 反馈管理 | 状态（未回复/已回复）、时间范围 |
| 资产管理 | 文件类型、大小范围、上传用户 |
| 操作日志 | 操作类型、操作人、模块名称 |
| 法律条款 | 条款类型、语言版本、发布状态 |

### 5.4 数据导出

#### 5.4.1 支持格式
- Excel格式（.xlsx）：结构化数据导出
- CSV格式（.csv）：大数据量导出
- JSON格式（.json）：API数据导出

#### 5.4.2 导出功能
- 筛选条件导出：按当前筛选结果导出
- 自定义列导出：选择需要导出的字段
- 分页导出：支持大量数据分批导出
- 异步导出：大文件后台导出并通知

---

## 6. 验收标准

### 6.1 功能验收

| 模块 | 核心功能 | 验收标准 |
| --- | --- | --- |
| 反馈管理 | 回复反馈 | ✅ 回复成功，状态更新，通知用户 |
| 资产管理 | 文件上传 | ✅ 支持多格式上传，进度显示，错误处理 |
| 服务监控 | 状态检查 | ✅ 实时状态显示，异常告警，历史记录 |
| 法律条款 | 内容编辑 | ✅ 富文本编辑，多版本管理，发布控制 |

### 6.2 性能验收

- **加载性能**：列表页首次加载 < 2秒
- **操作响应**：CRUD操作响应 < 1秒
- **文件上传**：大文件上传有进度反馈
- **搜索筛选**：实时搜索结果更新 < 500ms

### 6.3 用户体验验收

- **界面一致性**：所有模块使用统一的设计规范
- **操作便捷性**：常用操作不超过3步
- **错误友好性**：清晰的错误提示和解决建议
- **响应式适配**：支持桌面和移动端访问

---

## 7. 待扩展功能

### 7.1 反馈管理扩展
- [ ] 邮件通知：回复后自动发送邮件通知用户
- [ ] 评价系统：允许用户对回复进行评价
- [ ] 工单系统：复杂问题转为工单处理
- [ ] 统计报表：反馈数量和处理效率统计

### 7.2 资产管理扩展
- [ ] 图片压缩：上传时自动压缩图片
- [ ] 水印添加：支持为图片添加水印
- [ ] CDN加速：集成CDN加速文件访问
- [ ] 版本控制：文件版本历史管理

### 7.3 服务监控扩展
- [ ] 告警通知：邮件、短信、Webhook通知
- [ ] 性能监控：响应时间趋势图
- [ ] 自动重启：服务异常时自动重启
- [ ] 健康检查：第三方服务健康检查

### 7.4 法律条款扩展
- [ ] 用户同意记录：记录用户同意条款的时间
- [ ] A/B测试：新条款发布前的效果测试
- [ ] 国际化：支持更多语言版本
- [ ] 合规审计：条款变更的审计记录

---

**最后更新**：2025-11-16
**维护者**：开发团队
