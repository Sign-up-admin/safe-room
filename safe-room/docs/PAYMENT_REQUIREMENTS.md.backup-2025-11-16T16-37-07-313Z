---
title: PAYMENT REQUIREMENTS
version: v1.0.0
last_updated: 2025-11-16
status: active
category: technical
---
# 支付页面需求文档（Payment v1.2）

> 版本：v1.2 ⭐ 超预期实现版本
> 更新日期：2025-11-16
> 适用路由：`/index/pay`
> 关联模块：`pages/pay/index.vue` + 支付服务

---

## 📈 实现超越

实际实现已**全面超越**初始需求，新增以下超预期功能：

### ✨ 核心增强
- **四阶段支付流程**：确认订单 → 选择方式 → 支付监控 → 结果反馈
- **实时状态轮询**：`usePaymentStatus` 组合式API实现状态监控
- **多渠道支付支持**：微信、支付宝、银行卡等多种支付方式
- **安全保障体系**：SSL证书、多重验证、客服热线集成

### 🎯 用户体验提升
- **支付步骤可视化**：`PaymentStepper` 组件清晰展示进度
- **状态反馈动画**：`PaymentResult` 组件提供丰富的状态反馈
- **安全信任建设**：完整的安保图标和信任标识体系
- **响应式布局**：完美适配PC/平板/手机端

### 🔧 技术创新
- **组合式支付逻辑**：`usePaymentStatus` 封装轮询和状态管理
- **模块化支付组件**：`PaymentMethodCard`、`PaymentResult`、`PaymentStepper`
- **类型安全接口**：完整的支付相关TypeScript类型定义
- **错误处理机制**：完善的超时、重试、失败处理逻辑

---

## 0. 设计关键词

流程可视化 · 安全信任 · 多渠道支付 · 实时状态 · 结果闭环

---

## 1. 页面结构

| 顺序 | 区块 | 目的 |
| --- | --- | --- |
| ① | 支付步骤条 | 展示“确认订单 → 选择支付 → 支付中 → 结果” |
| ② | 订单摘要 | 展示商品信息（课程/会员卡）、金额、优惠 |
| ③ | 支付方式选择 | 支持多种支付方式，提示费率/到账时间 |
| ④ | 安全提示 | 展示证书、安全图标、服务热线 |
| ⑤ | 支付状态监控 | 显示支付中、成功、失败状态 |
| ⑥ | 结果反馈 | 成功/失败页面及下一步引导 |

---

## 2. 视觉规范

- 步骤条：黑金配色，当前步骤发光
- 订单卡：玻璃拟物 + 动态条码
- 支付方式卡片：带 Logo、颜色区分（但整体调和）
- 状态动画：使用 Lottie/GSAP 提示支付进度

---

## 3. 功能模块

### 3.1 订单摘要

- 从调用方页面传入订单 ID，展示商品详情、金额、优惠、预计到账时间
- 支持展开查看订单详情，包括商品清单、价格明细、优惠券使用情况、支付截止时间
- 支持展开查看更多信息（订单号、创建时间）

### 3.2 支付方式选择

| 支付方式 | 说明 | 状态显示 | 到账时间 |
| --- | --- | --- | --- |
| 微信支付 | 扫码/App支付，支持花呗分期 | ✅ 已实现 | 实时到账 |
| 支付宝 | 扫码/网页支付，支持花呗分期 | ✅ 已实现 | 实时到账 |
| 银行卡转账 | 对公账户，需备注订单号 | ✅ 已实现 | 1个工作日 |
| 余额支付 | 校验账户余额是否足够 | ⚠️ 预留接口 | 实时到账 |
| 分期支付 | 展示分期费用及利息说明 | ⚠️ 预留接口 | 实时到账 |

### 3.3 安全提示

- 展示支付安全认证（PCI、SSL）
- 提示：不要在陌生页面输入信息
- 提供客服联系方式

### 3.4 支付状态监控

- ✅ **轮询机制**：使用 `usePaymentStatus` 组合式API，支持2秒间隔轮询，5分钟超时
- ✅ **状态显示**：实时显示支付进度（确认订单 → 选择方式 → 支付中 → 结果）
- ✅ **二维码管理**：扫码倒计时显示，过期自动刷新
- ✅ **用户操作**：支持"我已完成支付"手动触发状态检查
- ✅ **错误重试**：最多3次重试，智能错误提示

### 3.5 结果反馈

- 成功：展示金额、支付方式、时间、订单编号、电子收据下载
- CTA：`查看订单详情`、`返回首页`、`继续预约课程`、`分享支付成功`
- 支持添加到支付记录，便于后续查询和开票
- 失败：展示具体失败原因、建议解决方案、重试按钮、联系客服
- 支持失败订单重新发起支付，保留原有订单信息

---

## 4. 交互与动效

| 互动 | 规范 |
| --- | --- |
| 支付方式 hover | 卡片上浮，显示手续费/优惠信息 |
| 二维码 | 倒计时环绕动画，过期变灰 |
| 状态切换 | 使用渐变/缩放过渡，避免突兀 |
| 失败提示 | Shake 动画 + 警示色 |

---

## 5. 响应式策略

| 终端 | 处理 |
| --- | --- |
| PC | 支付方式双列展示，二维码居中 |
| Pad | 单列展示，订单卡固定顶部 |
| Mobile | 使用底部抽屉展示支付方式，二维码可放大查看 |

---

## 6. 技术实现

| 领域 | 实现 | 状态 |
| --- | --- | --- |
| 数据 | 统一支付服务接口（`/pay/create`, `/pay/status`） | ✅ 已实现 |
| 状态管理 | Pinia 状态管理（订单状态、倒计时、支付方式） | ✅ 已实现 |
| 轮询机制 | `usePaymentStatus.ts` 组合式API，间隔2s，5分钟超时 | ✅ 已实现 |
| 安全保障 | HTTPS强制、SSL 256位加密、PCI DSS认证显示 | ✅ 已实现 |
| 组件化 | `PaymentStepper`、`PaymentMethodCard`、`PaymentResult` | ✅ 已实现 |
| 动画效果 | GSAP/Lottie 状态过渡动画 | ✅ 已实现 |

---

## 7. 开发交付件

1. ✅ **页面重构**：`src/pages/pay/index.vue` 完整实现
2. ✅ **核心组件**：
   - `PaymentStepper.vue` - 步骤条组件
   - `PaymentMethodCard.vue` - 支付方式卡片
   - `PaymentResult.vue` - 支付结果显示
3. ✅ **组合式API**：`usePaymentStatus.ts` - 支付状态轮询管理
4. ✅ **测试覆盖**：
   - 支付流程E2E测试（不同支付方式）
   - 超时场景单元测试
   - 失败重试逻辑测试
   - 移动端响应式测试

---

## 8. 验收标准

| 维度 | 标准 | 当前状态 |
| --- | --- | --- |
| 功能完整性 | 微信/支付宝/银行卡支付可用，状态实时刷新，轮询机制正常 | ✅ 已通过 |
| 安全合规 | HTTPS强制，SSL 256位加密，PCI DSS认证显示，敏感信息保护 | ✅ 已通过 |
| 性能指标 | 首屏加载 ≤ 2s，轮询2s间隔，5分钟超时，内存泄漏检查 | ✅ 已通过 |
| 响应式体验 | 移动端支付方式抽屉展示，二维码可放大，触摸友好 | ✅ 已通过 |
| 可访问性 | 支付方式键盘导航，状态文本可读，ARIA标签完善 | ✅ 已通过 |
| 用户体验 | 步骤条进度指示，错误重试机制，客服联系方式 | ✅ 已通过 |

---

## 9. 备注

- ✅ **已实现功能**：完整的支付闭环体验，支持多渠道支付方式
- ✅ **扩展预留**：余额支付、分期支付接口预留，易于后续接入
- ✅ **安全保障**：银行级安全标准，实时监控与异常处理
- ⚠️ **待扩展**：Apple Pay、数字人民币等新兴支付方式接入位
- ✅ **后端集成**：支付回调与消息推送机制已确认并实现


