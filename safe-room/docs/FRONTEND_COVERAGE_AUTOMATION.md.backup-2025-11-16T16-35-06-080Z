# å‰ç«¯æµ‹è¯•è¦†ç›–ç‡è‡ªåŠ¨åŒ–æŒ‡å—

## æ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜å‰ç«¯é¡¹ç›®ï¼ˆadmin å’Œ frontï¼‰çš„æµ‹è¯•è¦†ç›–ç‡è‡ªåŠ¨åŒ–é…ç½®å’Œä½¿ç”¨æ–¹æ³•ã€‚

## åŠŸèƒ½ç‰¹æ€§

### 1. è¦†ç›–ç‡é˜ˆå€¼æ£€æŸ¥

- **å½“å‰æœ€ä½é˜ˆå€¼**ï¼ˆæ¸è¿›å¼ç­–ç•¥ï¼‰:
  - Lines: 30%
  - Functions: 30%
  - Branches: 25%
  - Statements: 30%

- **é•¿æœŸç›®æ ‡é˜ˆå€¼**: 80%ï¼ˆæ‰€æœ‰æŒ‡æ ‡ï¼‰

### 2. è¦†ç›–ç‡æŠ¥å‘Šæ ¼å¼

æ”¯æŒå¤šç§æŠ¥å‘Šæ ¼å¼ï¼š
- `text` - ç»ˆç«¯æ–‡æœ¬è¾“å‡º
- `lcov` - LCOV æ ¼å¼ï¼ˆç”¨äº CI/CD é›†æˆï¼‰
- `html` - HTML æŠ¥å‘Šï¼ˆå¯åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ï¼‰
- `json` - JSON æ ¼å¼ï¼ˆç”¨äºç¨‹åºåŒ–å¤„ç†ï¼‰
- `json-summary` - JSON æ‘˜è¦ï¼ˆç”¨äºå¿«é€Ÿæ£€æŸ¥ï¼‰

### 3. CI/CD è‡ªåŠ¨åŒ–

GitHub Actions å·¥ä½œæµä¼šåœ¨ä»¥ä¸‹æƒ…å†µè‡ªåŠ¨è¿è¡Œï¼š
- æ¨é€åˆ° main/master/develop åˆ†æ”¯
- åˆ›å»º Pull Request
- æ‰‹åŠ¨è§¦å‘ï¼ˆworkflow_dispatchï¼‰

## ä½¿ç”¨æ–¹æ³•

### æœ¬åœ°è¿è¡Œè¦†ç›–ç‡æµ‹è¯•

#### Front é¡¹ç›®

```bash
cd springboot1ngh61a2/src/main/resources/front/front

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
npm run test:coverage

# è¯¦ç»†æ£€æŸ¥ï¼ˆverbose è¾“å‡ºï¼‰
npm run test:coverage:check

# ç”ŸæˆæŠ¥å‘Šå¹¶æ˜¾ç¤ºè·¯å¾„
npm run test:coverage:report

# CI æ¨¡å¼ï¼ˆç”Ÿæˆ JSON æŠ¥å‘Šï¼‰
npm run test:coverage:ci
```

#### Admin é¡¹ç›®

```bash
cd springboot1ngh61a2/src/main/resources/admin/admin

# è¿è¡Œè¦†ç›–ç‡æµ‹è¯•
npm run test:coverage

# è¯¦ç»†æ£€æŸ¥ï¼ˆverbose è¾“å‡ºï¼‰
npm run test:coverage:check

# ç”ŸæˆæŠ¥å‘Šå¹¶æ˜¾ç¤ºè·¯å¾„
npm run test:coverage:report

# CI æ¨¡å¼ï¼ˆç”Ÿæˆ JSON æŠ¥å‘Šï¼‰
npm run test:coverage:ci
```

#### æ ¹ç›®å½•ï¼ˆè¿è¡Œæ‰€æœ‰é¡¹ç›®ï¼‰

```bash
# è¿è¡Œæ‰€æœ‰é¡¹ç›®çš„è¦†ç›–ç‡æµ‹è¯•
npm run coverage

# æ£€æŸ¥æ‰€æœ‰é¡¹ç›®çš„è¦†ç›–ç‡
npm run coverage:check

# ç”Ÿæˆæ‰€æœ‰é¡¹ç›®çš„è¦†ç›–ç‡æŠ¥å‘Š
npm run coverage:report
```

### æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š

è¦†ç›–ç‡æŠ¥å‘Šç”Ÿæˆåœ¨ `coverage/` ç›®å½•ä¸‹ï¼š

```bash
# æ‰“å¼€ HTML æŠ¥å‘Šï¼ˆåœ¨æµè§ˆå™¨ä¸­ï¼‰
open coverage/index.html  # macOS
start coverage/index.html  # Windows
xdg-open coverage/index.html  # Linux
```

### Pre-commit Hookï¼ˆå¯é€‰ï¼‰

é»˜è®¤æƒ…å†µä¸‹ï¼Œpre-commit hook ä¸ä¼šè¿è¡Œè¦†ç›–ç‡æ£€æŸ¥ï¼ˆé¿å…å½±å“å¼€å‘é€Ÿåº¦ï¼‰ã€‚

#### å¯ç”¨ Pre-commit è¦†ç›–ç‡æ£€æŸ¥

ç¼–è¾‘ `.husky/pre-commit` æ–‡ä»¶ï¼Œå–æ¶ˆæ³¨é‡Šä»¥ä¸‹å†…å®¹ï¼š

```bash
if [ "$ENABLE_COVERAGE_CHECK" = "true" ]; then
  echo "ğŸ” è¿è¡Œè¦†ç›–ç‡æ£€æŸ¥..."
  npm run test:coverage || exit 1
fi
```

æˆ–è€…é€šè¿‡ç¯å¢ƒå˜é‡ä¸´æ—¶å¯ç”¨ï¼š

```bash
# Linux/macOS
export ENABLE_COVERAGE_CHECK=true
git commit -m "your message"

# Windows PowerShell
$env:ENABLE_COVERAGE_CHECK="true"
git commit -m "your message"
```

### CI/CD é›†æˆ

GitHub Actions å·¥ä½œæµä¼šè‡ªåŠ¨ï¼š

1. å®‰è£…ä¾èµ–
2. è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
3. æ£€æŸ¥è¦†ç›–ç‡é˜ˆå€¼ï¼ˆå¦‚æœä½äºé˜ˆå€¼ï¼Œæ„å»ºå¤±è´¥ï¼‰
4. ä¸Šä¼ è¦†ç›–ç‡æŠ¥å‘Šä½œä¸ºæ„å»ºäº§ç‰©
5. ç”Ÿæˆè¦†ç›–ç‡æ‘˜è¦

#### æŸ¥çœ‹ CI è¦†ç›–ç‡æŠ¥å‘Š

1. è¿›å…¥ GitHub Actions é¡µé¢
2. é€‰æ‹©å¯¹åº”çš„ workflow run
3. åœ¨ "Artifacts" éƒ¨åˆ†ä¸‹è½½è¦†ç›–ç‡æŠ¥å‘Š
4. è§£å‹åæ‰“å¼€ `coverage/index.html` æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š

## é…ç½®æ–‡ä»¶è¯´æ˜

### Vitest é…ç½®

é…ç½®æ–‡ä»¶ï¼š`vitest.config.ts`

å…³é”®é…ç½®é¡¹ï¼š

```typescript
coverage: {
  provider: 'v8',
  reporter: ['text', 'lcov', 'html', 'json', 'json-summary'],
  reportsDirectory: './coverage',
  thresholds: {
    lines: 30,
    functions: 30,
    branches: 25,
    statements: 30,
  },
}
```

### GitHub Actions å·¥ä½œæµ

é…ç½®æ–‡ä»¶ï¼š`.github/workflows/frontend-test-coverage.yml`

å·¥ä½œæµç‰¹ç‚¹ï¼š
- ä½¿ç”¨çŸ©é˜µç­–ç•¥å¹¶è¡Œè¿è¡Œä¸¤ä¸ªé¡¹ç›®çš„æµ‹è¯•
- è‡ªåŠ¨ä¸Šä¼ è¦†ç›–ç‡æŠ¥å‘Šä½œä¸ºæ„å»ºäº§ç‰©
- ç”Ÿæˆè¦†ç›–ç‡æ‘˜è¦

## è¦†ç›–ç‡é˜ˆå€¼ç­–ç•¥

### æ¸è¿›å¼æå‡ç­–ç•¥

å½“å‰é‡‡ç”¨æ¸è¿›å¼ç­–ç•¥ï¼Œå…è®¸é€æ­¥æå‡è¦†ç›–ç‡ï¼š

1. **ç¬¬ä¸€é˜¶æ®µ**ï¼ˆå½“å‰ï¼‰: æœ€ä½é˜ˆå€¼ 30%
2. **ç¬¬äºŒé˜¶æ®µ**: æå‡è‡³ 50%
3. **ç¬¬ä¸‰é˜¶æ®µ**: æå‡è‡³ 70%
4. **æœ€ç»ˆç›®æ ‡**: è¾¾åˆ° 80%

### ä¿®æ”¹é˜ˆå€¼

ç¼–è¾‘ `vitest.config.ts` ä¸­çš„ `thresholds` é…ç½®ï¼š

```typescript
thresholds: {
  lines: 30,      // ä¿®æ”¹ä¸ºæœŸæœ›çš„ç™¾åˆ†æ¯”
  functions: 30,
  branches: 25,
  statements: 30,
}
```

## æ’é™¤æ–‡ä»¶

ä»¥ä¸‹æ–‡ä»¶/ç›®å½•é»˜è®¤æ’é™¤åœ¨è¦†ç›–ç‡ç»Ÿè®¡ä¹‹å¤–ï¼š

- `src/main.ts` / `src/main.js` - å…¥å£æ–‡ä»¶
- `src/router/**` - è·¯ç”±é…ç½®
- `src/**/__tests__/**` - æµ‹è¯•æ–‡ä»¶ç›®å½•
- `src/**/*.d.ts` - TypeScript å£°æ˜æ–‡ä»¶
- `src/**/types/**` - ç±»å‹å®šä¹‰ç›®å½•
- `src/**/*.config.{ts,js}` - é…ç½®æ–‡ä»¶
- `src/**/env.d.ts` - ç¯å¢ƒç±»å‹å®šä¹‰

## æ•…éšœæ’é™¤

### è¦†ç›–ç‡æµ‹è¯•å¤±è´¥

1. **æ£€æŸ¥é˜ˆå€¼è®¾ç½®**ï¼šç¡®ä¿å½“å‰è¦†ç›–ç‡é«˜äºé…ç½®çš„é˜ˆå€¼
2. **æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š**ï¼šè¿è¡Œ `npm run test:coverage:check` æŸ¥çœ‹è¯¦ç»†è¾“å‡º
3. **æ£€æŸ¥æ’é™¤é…ç½®**ï¼šç¡®è®¤ä¸éœ€è¦æµ‹è¯•çš„æ–‡ä»¶å·²æ­£ç¡®æ’é™¤

### CI æ„å»ºå¤±è´¥

1. **æŸ¥çœ‹ GitHub Actions æ—¥å¿—**ï¼šæ£€æŸ¥å…·ä½“çš„å¤±è´¥åŸå› 
2. **ä¸‹è½½è¦†ç›–ç‡æŠ¥å‘Š**ï¼šä» Artifacts ä¸‹è½½æŠ¥å‘ŠæŸ¥çœ‹è¯¦æƒ…
3. **æœ¬åœ°éªŒè¯**ï¼šåœ¨æœ¬åœ°è¿è¡Œ `npm run test:coverage` å¤ç°é—®é¢˜

### Pre-commit Hook å¤ªæ…¢

å¦‚æœå¯ç”¨ pre-commit è¦†ç›–ç‡æ£€æŸ¥åæäº¤å˜æ…¢ï¼š

1. **ä¸´æ—¶ç¦ç”¨**ï¼šè®¾ç½® `ENABLE_COVERAGE_CHECK=false`
2. **ä»…æ£€æŸ¥å˜æ›´æ–‡ä»¶**ï¼šä¿®æ”¹ hook è„šæœ¬ï¼Œåªæµ‹è¯•å˜æ›´çš„æ–‡ä»¶ï¼ˆéœ€è¦è‡ªå®šä¹‰è„šæœ¬ï¼‰
3. **ä½¿ç”¨ CI æ£€æŸ¥**ï¼šä¾èµ– CI/CD è¿›è¡Œè¦†ç›–ç‡æ£€æŸ¥ï¼Œä¸åœ¨æœ¬åœ° pre-commit ä¸­è¿è¡Œ

## æœ€ä½³å®è·µ

1. **å¼€å‘æ—¶**ï¼šä½¿ç”¨ `npm run test:unit:watch` è¿›è¡Œå¿«é€Ÿè¿­ä»£
2. **æäº¤å‰**ï¼šè¿è¡Œ `npm run test:coverage` ç¡®ä¿è¦†ç›–ç‡è¾¾æ ‡
3. **CI/CD**ï¼šä¾èµ–è‡ªåŠ¨åŒ–å·¥ä½œæµè¿›è¡Œå¼ºåˆ¶æ£€æŸ¥
4. **å®šæœŸå®¡æŸ¥**ï¼šå®šæœŸæŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Šï¼Œè¯†åˆ«éœ€è¦è¡¥å……æµ‹è¯•çš„æ¨¡å—
5. **æ¸è¿›æå‡**ï¼šé€æ­¥æé«˜è¦†ç›–ç‡é˜ˆå€¼ï¼Œé¿å…ä¸€æ¬¡æ€§è®¾ç½®è¿‡é«˜ç›®æ ‡

## ç›¸å…³æ–‡æ¡£

- [å‰ç«¯æµ‹è¯•æŠ¥å‘Š](FRONTEND_TEST_REPORT.md)
- [æµ‹è¯•æŒ‡å—](TESTING.md)
- [å¼€å‘æŒ‡å—](DEVELOPMENT.md)

