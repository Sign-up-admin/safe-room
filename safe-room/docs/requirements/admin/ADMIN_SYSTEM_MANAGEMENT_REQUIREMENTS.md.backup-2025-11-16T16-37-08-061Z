---
title: ADMIN SYSTEM MANAGEMENT REQUIREMENTS
version: v1.0.0
last_updated: 2025-11-16
status: active
category: technical
---
# 系统管理需求文档（Admin System Management v2.0）

> 版本：v2.0
> 更新日期：2025-11-16（基于现有实现更新）
> 适用路由：`/users`, `/operation-log`, `/service-status`, `/legal-terms`
> 关联组件：`src/views/modules/users/list.vue` 等专用组件

---

## 0. 设计关键词

安全可控 · 审计追溯 · 权限精细 · 操作透明 · 合规管理

> 目标：确保系统安全、操作可追溯、权限可控，满足合规要求。

---

## 1. 模块概览

| 模块 | 表名 | 用途 | 权限要求 |
| --- | --- | --- | --- |
| 管理员账号 | `users` | 管理后台管理员账号、角色分配 | 仅超级管理员可操作 |
| 操作日志 | `operation_log` | 记录所有关键操作，支持审计 | 查看、导出（不可编辑/删除） |
| 权限管理 | `menu.ts`（前端配置） | 管理角色权限配置 | 需代码部署（或提供配置界面） |
| 系统消息 | （待实现） | 系统通知、公告推送 | 查看、标记已读 |

---

## 2. 管理员账号管理（Users）

### 2.1 功能说明

管理后台管理员账号，包括账号创建、角色分配、状态管理、密码重置等。

### 2.2 数据字段

| 字段 | 类型 | 说明 | 必填 |
| --- | --- | --- | --- |
| `id` | Long | 主键 | 是 |
| `username` | String | 用户名（唯一） | 是 |
| `password` | String | 密码（加密存储） | 是 |
| `image` | String | 头像URL | 否 |
| `role` | String | 角色（如"管理员"、"客服"） | 是 |
| `status` | Integer | 状态（0-正常，1-锁定） | 是 |
| `addtime` | Date | 创建时间 | 自动 |

### 2.3 功能需求

| 功能 | 说明 | 接口 |
| --- | --- | --- |
| 列表查询 | 支持搜索用户名、按角色筛选、按状态筛选、分页 | `GET /users/page` |
| 新增账号 | 创建新管理员账号，设置用户名、密码、角色 | `POST /users/save` |
| 编辑账号 | 修改角色、状态、头像（不可修改用户名） | `POST /users/update` |
| 删除账号 | 删除管理员账号（不可删除当前登录账号） | `POST /users/delete` |
| 密码重置 | 将密码重置为默认值（如"123456"） | `POST /users/resetPass` |
| 账号锁定 | 锁定/解锁账号，防止登录 | 通过 `status` 字段控制 |

### 2.4 交互规范

- **权限控制**：仅超级管理员可管理其他管理员账号
- **用户名唯一性**：新增时检查用户名是否已存在
- **密码安全**：新增/重置密码时需二次确认
- **状态管理**：锁定账号后无法登录，需管理员解锁
- **删除保护**：不可删除当前登录账号，删除前二次确认

### 2.5 角色说明

| 角色 | 权限范围 | 说明 |
| --- | --- | --- |
| 超级管理员 | 全部权限 | 可管理所有模块和账号 |
| 管理员 | 业务模块权限 | 可管理业务数据，不可管理账号 |
| 客服 | 查看和回复权限 | 可查看数据、回复留言，不可删除 |
| 教练 | 个人数据权限 | 仅可查看和管理自己的课程、预约 |

---

## 3. 操作日志（Operation Log）

### 3.1 功能说明

记录所有关键操作，包括数据新增、编辑、删除、导出等，支持审计和追溯。

### 3.2 数据字段（建议）

| 字段 | 类型 | 说明 | 必填 |
| --- | --- | --- | --- |
| `id` | Long | 主键 | 是 |
| `userid` | Long | 操作人ID | 是 |
| `username` | String | 操作人用户名 | 是 |
| `table` | String | 操作表名/模块 | 是 |
| `type` | String | 操作类型（Add/Edit/Delete/Export等） | 是 |
| `content` | String | 操作内容描述 | 是 |
| `ip` | String | 操作IP地址 | 是 |
| `addtime` | Date | 操作时间 | 自动 |

### 3.3 功能需求

| 功能 | 说明 | 接口 |
| --- | --- | --- |
| 列表查询 | 支持按操作人、操作类型、表名、时间范围筛选、分页 | `GET /operationLog/page` |
| 查看详情 | 查看操作详情，包括操作前后数据对比 | `GET /operationLog/info/{id}` |
| 导出日志 | 导出Excel格式的操作日志 | `GET /operationLog/export` |
| 日志归档 | 定期归档历史日志（后台任务） | - |

### 3.4 交互规范

- **只读模式**：操作日志不可编辑、不可删除（或仅超级管理员可删除）
- **筛选功能**：支持多维度筛选，快速定位问题
- **详情展示**：显示操作前后数据对比（如有）
- **导出功能**：支持按筛选条件导出Excel

### 3.5 记录范围

| 操作类型 | 是否记录 | 说明 |
| --- | --- | --- |
| 数据新增 | 是 | 记录新增内容和操作人 |
| 数据编辑 | 是 | 记录编辑前后对比 |
| 数据删除 | 是 | 记录删除内容和操作人 |
| 数据导出 | 是 | 记录导出内容和操作人 |
| 登录/退出 | 是 | 记录登录IP和时间 |
| 密码修改 | 是 | 记录密码修改操作 |
| 权限变更 | 是 | 记录权限变更操作 |

---

## 4. 权限管理

### 4.1 功能说明

管理角色权限配置，控制不同角色可访问的菜单和操作按钮。

### 4.2 权限配置方式

当前系统采用前端配置文件 `menu.ts` 管理权限，后续可扩展为可视化配置界面。

### 4.3 权限结构

```typescript
{
  roleName: 'Administrator',  // 角色名称
  backMenu: [                 // 后台菜单
    {
      menu: 'User Management',  // 菜单名称
      child: [                  // 子菜单
        {
          tableName: 'yonghu',  // 表名/模块名
          menu: 'User',         // 菜单显示名称
          buttons: ['Add', 'View', 'Edit', 'Delete'],  // 可用操作
          allButtons: ['Add', 'View', 'Edit', 'Delete', 'Export']  // 所有可用操作
        }
      ]
    }
  ]
}
```

### 4.4 权限键说明

| 权限键 | 说明 | 用途 |
| --- | --- | --- |
| `Add` | 新增 | 显示新增按钮，允许创建数据 |
| `View` | 查看 | 显示查看按钮，允许查看详情 |
| `Edit` | 编辑 | 显示编辑按钮，允许修改数据 |
| `Delete` | 删除 | 显示删除按钮，允许删除数据 |
| `Export` | 导出 | 显示导出按钮，允许导出数据 |
| `Review` | 审核 | 显示审核按钮，允许审核数据 |
| `Pay` | 支付 | 显示支付按钮，允许处理支付 |

### 4.5 权限检查

- **前端检查**：使用 `isAuth(tableName, key)` 函数检查权限
- **后端验证**：所有接口需验证Token和角色权限
- **双重保障**：前端隐藏UI，后端拦截请求

---

## 5. 系统消息（待实现）

### 5.1 功能说明

系统通知、公告推送、操作提醒等消息管理。

### 5.2 功能需求（规划）

| 功能 | 说明 |
| --- | --- |
| 消息列表 | 显示所有系统消息，支持按类型筛选 |
| 消息详情 | 查看消息详细内容 |
| 标记已读 | 标记消息为已读状态 |
| 消息推送 | 系统自动推送重要通知 |
| 消息删除 | 删除已读消息 |

### 5.3 消息类型（规划）

- 系统公告
- 操作提醒
- 异常告警
- 数据统计报告

---

## 6. 安全与合规要求

### 6.1 账号安全

- 密码加密存储，不可明文显示
- 支持账号锁定，防止暴力破解
- 登录失败次数限制
- 定期要求修改密码（可选）

### 6.2 操作审计

- 所有关键操作记录日志
- 日志不可篡改（或仅超级管理员可删除）
- 支持日志导出和归档
- 保留至少90天操作日志

### 6.3 权限控制

- 最小权限原则，默认无权限
- 权限变更需记录日志
- 超级管理员权限不可被普通管理员修改

### 6.4 数据保护

- 敏感数据脱敏显示
- 删除操作需二次确认
- 支持数据备份和恢复

---

## 7. 响应式策略

| 终端 | 处理 |
| --- | --- |
| ≥1200px | 列表和表单正常显示 |
| 992-1199px | 列表可横向滚动，表单适配 |
| <992px | 建议使用桌面端，移动端仅查看 |

---

## 8. 验收标准

| 维度 | 标准 |
| --- | --- |
| 功能完整性 | 账号管理、日志查看功能正常 |
| 权限控制 | 权限检查正确，无越权操作 |
| 操作审计 | 关键操作正确记录日志 |
| 安全性 | 密码加密、账号锁定功能正常 |
| 用户体验 | 操作流畅，错误提示清晰 |

---

## 9. 待办/扩展

- [ ] 实现操作日志模块（后端接口 + 前端页面）
- [ ] 实现权限管理可视化配置界面
- [ ] 实现系统消息推送功能
- [ ] 添加登录失败次数限制
- [ ] 添加密码强度校验
- [ ] 添加操作日志数据对比功能
- [ ] 实现日志自动归档功能

---

